bases:
- ../erxes-k8s

resources:
- erxes-kubedb-mongodb.yaml

patchesStrategicMerge:
- patch-erxes-use-kubedb.yaml

vars:
- name: MONGO_HOST
  objref:
    apiVersion: kubedb.com/v1alpha1
    kind: MongoDB
    name: erxes-mongodb

configMapGenerator:
- name: erxes-mongodb-scripts
  files:
  - init-erxes-mongodb.js

configurations:
- kubedb-kustomize-configurations.yaml

secretGenerator:
- name: erxes-engages-env
  behavior: merge
  literals:
  - MONGO_URL=mongodb://erxes-engages:erxes-engages@$(MONGO_HOST)/erxes_engages
- name: erxes-integrations-env
  behavior: merge
  literals:
  - MONGO_URL=mongodb://erxes-integrations:erxes-integrations@$(MONGO_HOST)/erxes_integrations
